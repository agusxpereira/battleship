(()=>{"use strict";const t=function(t,e){return{id:t,lenght:e,hits:0,hit:function(){return console.log("is sunk?: "+this.isSunk()),!1===this.isSunk()?(this.hits=this.hits+1,console.log("is sunk? "+this.isSunk()),console.log("hits: "+this.hits),!0):(console.log("Este barco ya ha sido hundido"),!1)},isSunk:function(){return this.hits===this.lenght},isPositioned:!1}},e=function(t=null){let e=[],o=[],n=[],s=[];for(let t=0;t<10;t++){e.length<10&&e.push([]);for(let o=0;o<10;o++)e[t].length<10&&e[t].push("")}const r=function(t,e,o,n){let s=e,r=o.x,l=o.y,i=n.x,a=n.y;if(s.lenght===i+1-(r+1)||s.lenght===a+1-(l+1)){if(r==i){let o=l;for(;o<a;)t[r][o]=e.id,o++;return!0}if(l==a){let o=r;for(;i>o;)t[o][l]=e.id,o++;return!0}return!1}return!1};return{board:e,viewBoard:function(){for(let t=0;t<e.length;t++){const o=e[t];let n="";for(let t=0;t<o.length;t++)""===o[t]?n+="[ ]":n+="["+o[t]+"]";return n}},posShip:r,automaticPos:function(t){let o=0,n=0;for(;o<1;){let s=Math.floor(2*Math.random()),l=0,i=0,a=0,u=0,c={},d={};if(1==s){if(l=Math.floor(10*Math.random()),i=Math.floor(10*Math.random()),a=l+Math.floor(Math.random()*t.lenght+1),u=i,n=0,a<10&&""===e[l][i]){for(let t=a;t>l;t--)""===e[t][i]&&n++;c={x:l,y:i},d={x:a,y:u}}}else if(l=Math.floor(10*Math.random()),i=Math.floor(10*Math.random()),a=l,u=i+Math.floor(Math.random()*t.lenght+1),n=0,u<10&&""===e[l][i]){for(let t=u;t>i;t--)""===e[l][t]&&n++;c={x:l,y:i},d={x:a,y:u}}if((1===s&&a<10||0===s&&u<10)&&(t.lenght==a+1-(l+1)||t.lenght==u+1-(i+1))){let s=!1;t.lenght===n&&(s=r(e,t,c,d)),1==s?(o+=1,t.isPositioned=!0):console.log("No habÃ­a posciones definidas")}}},getPos:function(t,o){return e[t][o]},getShip:function(o){let n=o.x,s=o.y;if(""!==e[n][s]){let o=e[n][s];t.forEach((t=>{if(t.id===o)return t}))}},addMissShot:function(t){let e={x:t.x,y:t.y};o.push(e)},getMissesShots:function(){return o},addSuccessful_shot:function(t){t.x,t.y,s.push(t)},getSuccessful_shots:function(){return s}}},o=function(o="Computer"){let n=o,s=[],r=!1,l=0;const i=t(1,5),a=t(2,4),u=t(3,3),c=t(4,3),d=t(5,2);s.push(i),s.push(a),s.push(u),s.push(c),s.push(d);const h=e(s);return{userName:n,userBoard:h,attack:function(t,e){if(""!==t.board[e.x][e.y]){t.addSuccessful_shot({x:e.x,y:e.y});let o=t.board[e.x][e.y],n="";return s.forEach((t=>{t.id===o&&(n=t)})),console.log(n),n.hit(),console.log(n.isSunk()),1==n.isSunk()&&l++,!0}return t.addMissShot({x:e.x,y:e.y}),!1},fleet:s,isFleetSunked:function(){let t=0;return s.forEach((e=>{!0===e.isSunk()&&t++})),5==t},getShift:function(){return r},setShift:function(t){r=t},getSunkenShips:function(){return l}}},n=document.getElementById("ui-player-one");document.getElementById("ui-player-two"),console.log(n);const s=function(t,e){console.log(`${e}`);const o=document.getElementById(`${e}`);let n=-1,s=-1;t.forEach((t=>{n++,s=-1,t.forEach((t=>{s++;let e=document.createElement("div");e.classList.add("box"),e.innerHTML="",o.appendChild(e),e.dataset.row=n,e.dataset.column=s}))}))},r=function(t,e,o){let n=o.userBoard.getMissesShots(),s=o.userBoard.getSuccessful_shots();document.querySelectorAll(`#${e}>.box`).forEach((t=>{n.forEach((e=>{e.x==t.dataset.row&&t.dataset.column==e.y&&(t.textContent="X")})),s.forEach((e=>{e.x==t.dataset.row&&t.dataset.column==e.y&&(t.textContent="O")}))}))},l=function(t,e,o){let n,s={};return s!={}&&(s.x=Number(t.dataset.row),s.y=Number(t.dataset.column)),!0!==e.getShift()||!1!==o.getShift()||n?!0!==o.getShift()||!1!==e.getShift()||n?void 0:(n=o.attack(e.userBoard,s),0==n?(e.setShift(!0),void o.setShift(!1)):void 0):(n=e.attack(o.userBoard,s),0==n?(e.setShift(!1),void o.setShift(!0)):void console.log(n))},i=function(t,e,o){document.querySelectorAll(t).forEach((t=>{t.addEventListener("click",(n=>(console.log(t),!0===e.getShift()&&"display-board-two"==n.target.parentNode.id?""==t.textContent?(l(t,e,o),void r(0,"display-board-two",o)):(r(0,"display-board-two",o),void l(t,e,o)):!0===o.getShift()&&"display-board-one"==n.target.parentNode.id?(t.textContent,l(t,e,o),void r(0,"display-board-one",e)):void 0)))}))},a=function(t){let e=!1,n="";const r=o(t);let l=r.fleet;r.setShift(!0);const a=o("Computer");a.setShift(!1);let u=a.fleet;var c;l.forEach((t=>{r.userBoard.automaticPos(t)})),u.forEach((t=>{a.userBoard.automaticPos(t)})),c=r.userName,document.querySelector(".user-name").textContent=c,s(r.userBoard.board,"display-board-one"),s(a.userBoard.board,"display-board-two"),i("#display-board-two>.box",r,a),i("#display-board-one>.box",r,a);let d=setInterval((function(){0==e?(function(t,e){1==t.getShift()&&0==e.getShift()?(document.querySelector("#shift-sunked-one").textContent=`${t.getSunkenShips()}`,document.querySelector("#shift-player-one").textContent="It's your shift!",document.querySelector("#shift-player-two").textContent="",document.querySelectorAll("#display-board-two>.box").forEach((t=>{t.classList.add("clickeable")})),document.querySelectorAll("#display-board-one>.box").forEach((t=>{t.classList.remove("clickeable")}))):0==t.getShift()&&1==e.getShift()&&(document.querySelector("#shift-sunked-two").textContent=`${e.getSunkenShips()}`,document.querySelector("#shift-player-one").textContent="",document.querySelector("#shift-player-two").textContent="It's your shift!",document.querySelectorAll("#display-board-one>.box").forEach((t=>{t.classList.add("clickeable")})),document.querySelectorAll("#display-board-two>.box").forEach((t=>{t.classList.remove("clickeable")})))}(r,a),1==r.getShift()&&0==a.getShift()&&!0===r.isFleetSunked()?(e=!0,n="PC"):1==a.getShift()&&0==r.getShift()&&!0===a.isFleetSunked()&&(e=!0,n="Player 1")):clearInterval(d)}),1e3)};document.addEventListener("DOMContentLoaded",(()=>{let t=document.querySelector(".choose-game");t.classList.toggle("show"),console.log("modal"),document.getElementById("confirm-player-vs-pc").addEventListener("click",(()=>{console.log("click");let e=document.querySelector(".player-vs-pc");t.classList.toggle("show"),e.classList.toggle("show"),document.getElementById("send-info-user").addEventListener("click",(t=>{t.preventDefault();let o="";null!==document.getElementById("username").value?(o=document.getElementById("username").value,document.getElementById("username").value=""):o="Player 1",document.getElementById("get-info-user").reset(),e.classList.toggle("show"),a(o)}))}))}))})();